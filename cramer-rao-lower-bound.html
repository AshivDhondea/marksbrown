<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>

    <title>Cramer Rao Lower Bound</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Cramer Rao Lower Bound"/>
            <meta property="og:url" content="http://markbrown.io/cramer-rao-lower-bound.html"/>
            <meta property="og:description" content="The time resolution of the scintillator detector may be estimated from a probability density function (PDF) describing the signal generated by a given particle interaction. To understand how this is accomplished, a (brief) introduction to Likelihood statistics is given. The likelihood function is the probability of ‘guessed’ parameters for observed ..."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://markbrown.io/theme/css/bootstrap.simplex.min.css" type="text/css"/>
    <link href="http://markbrown.io/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://markbrown.io/theme/css/bootstrap-glyphicons.css" rel="stylesheet">
    <link href="http://markbrown.io/theme/css/pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="http://markbrown.io/theme/css/style.css" type="text/css"/>
    <link rel="stylesheet" href="http://markbrown.io/theme/css/custom.css" type="text/css"/>

    <!-- JavaScript plugins (requires jQuery) -->
    <script src="//code.jquery.com/jquery.min.js"></script>

        <link href="http://markbrown.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="markbrown.io ATOM Feed"/>

    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-46836325-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://markbrown.io" class="navbar-brand">markbrown.io</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li><a href="http://markbrown.io/about/">About</a></li>
                        <li><a href="http://markbrown.io/cv/">Curriculum Vitae</a></li>
                        <li><a href="http://markbrown.io/research/">Research</a></li>
                        <li><a href="http://markbrown.io/tutoring/">Tutoring</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://markbrown.io/archives.html"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://markbrown.io/cramer-rao-lower-bound.html"
                       rel="bookmark"
                       title="Permalink to Cramer Rao Lower Bound">
                        Cramer Rao Lower Bound
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>Fri 29 November 2013
    </span>



</footer><!-- /.post-info -->                    </div>
                </div>
                <p>The time resolution of the scintillator detector may be estimated from a probability density function (<span class="caps">PDF</span>) describing the signal generated by a given particle interaction. To understand how this is accomplished, a (brief) introduction to Likelihood statistics is&nbsp;given.</p>
<p>The likelihood function is the probability of &#8216;guessed&#8217; parameters for observed data. Whereas the <span class="caps">PDF</span> is the probability of data given parameters, the likelihood function is the probability of parameters given data. It is intuitive to see that the likelihood function will reach a maximum when the parameters are the most likely. We therefore define
<mathjax>\begin{align}
L(\theta|t) = p(t|\Theta)\\\\
\lambda(t|\Theta) = \ln{p(t|\Theta)}
\end{align}</mathjax>
where <mathjax>$L$</mathjax> is the likelihood function, <mathjax>$p$</mathjax> is the probability density function, <mathjax>$\lambda$</mathjax> is the log-likelihood function, <mathjax>$t$</mathjax> is a given observed event and <mathjax>$\theta$</mathjax> is the parameter under interest. For <mathjax>$N$</mathjax> individual events, a random sample <mathjax>$\vec{t}=\{t_1,t_2,\cdots,t_n\}$</mathjax>, with no order implied, these equations become
<mathjax>\begin{align}
L(\Theta|\vec{t}) = \prod^n_{i=1}p(t_i|\Theta)\\\\
\lambda_n(\vec{t}|\Theta) = \sum^n_{i=1}\lambda(t_i|\Theta)
\end{align}</mathjax>
As the likelihood function defines the probability the estimated parameters are correct, it is natural to maximise <mathjax>$L$</mathjax> to find the most likely parameters for the sample <mathjax>$\vec{t}$</mathjax>. The definition above however will generally be zero, except for exceedingly close to the correct values, due to the product of many infinitesimally small numbers. Due to this we generally maximise the log-likelihood as the resulting parameters we find will be the same, but the distribution of the log-likelihood function about the optimal parameters will be smoother. This method is known as Maximum Likelihood Estimation (<span class="caps">MLE</span>) <a class="footnote-reference" href="#id2" id="id1">[1]</a>&nbsp;.</p>
<p>The parameter of interest for the timing performance of a scintillator detector is the absolute time of arrival of a high energy particle within the scintillator crystal. The standard deviation of the uncertainty within this parameter we shall refer to as the time&nbsp;resolution.</p>
<div class="section" id="the-scintillation-mechanism">
<h2>The Scintillation&nbsp;Mechanism</h2>
<img alt="pdf and cdf for LSO" src="/images/LSO-pdf-cdf.png" style="width: 80%;" />
<p>The rate of photon generation within the scintillator crystal typically described by two exponentials[<span class="caps">REFERENCE</span>]. The <span class="caps">PDF</span> is given&nbsp;by</p>
<p><mathjax>\begin{align}
p(t|\Theta,\tau_r,\tau_d) = \begin{cases}\frac{1}{\tau_d-\tau_r}\Big[e^{\frac{-(t-\Theta)}{\tau_d}}-e^{\frac{-(t-\Theta)}{\tau_r}}\Big] &amp;\qquad\mbox{if } t \geq\Theta \\\\
0 &amp;\qquad \mbox{if } t &lt; \Theta \end{cases}
\label{eqn:dual}
\end{align}</mathjax></p>
<p>where <mathjax>$\tau_r$</mathjax> is the rise time, <mathjax>$\tau_d$</mathjax> is the decay time and <mathjax>$\Theta$</mathjax> is the particle conversion time within the scintillator&nbsp;crystal.</p>
<div class="section" id="cramer-rao-derivation">
<h3>Cramer-Rao&nbsp;Derivation</h3>
<p>We begin by determining the expectation value of
<mathjax>$\frac{\partial\lambda_n}{\partial\Theta}$</mathjax></p>
<p><mathjax>\begin{align}
\frac{\partial\lambda_n}{\partial\Theta} = \frac{\partial}{\partial\Theta}\ln p_n(\vec{t}|\Theta)=
\frac{1}{p_n}\frac{\partial p_n}{\partial\Theta}
\\\\
\textrm{E}[\Big(\frac{\partial\lambda_n}{\partial\Theta}\Big)] = \int\cdots\int \frac{1}{p_n}\frac{\partial p_n}{\partial\Theta}f_n dt_1\cdots dt_n\\\\
\textrm{E}[\Big(\frac{\partial\lambda_n}{\partial\Theta}\Big)] = \int\cdots\int \frac{\partial p_n}{\partial\Theta} dt_1\cdots dt_n = 0
\label{eqn:tozero}
\end{align}</mathjax></p>
<p>This equals zero because one of the properties of the <span class="caps">PDF</span>&nbsp;is</p>
<div class="formula">
<span class="limits"><sup class="limit"> </sup><span class="limit"><span class="symbol">∫</span></span><sub class="limit"><i>S</i></sub></span><i>p</i>(<i>t</i>|Θ)<i>dt</i> = 1
</div>
<p>where <span class="formula"><i>S</i></span>
 is every possible value of <span class="formula"><i>t</i></span>
. We can use this
result to redefine the Fisher information (equation [eqn:fisher]) in
terms of variance such&nbsp;that</p>
<div class="formula">
<span class="textrm">Var</span>[<i>X</i>]: = <span class="textrm">Cov</span>[<i>X</i>, <i>X</i>] = <i>E</i>[<i>X</i><sup>2</sup>] − <i>E</i>[<i>X</i>]<sup>2</sup>
</div>
<p>Therefore</p>
<p><mathjax>\begin{align}
\textrm{Var}[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)] =
E[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)^2]-E[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)]^2\\\\
I(\Theta) = \textrm{Var}[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)] =
E[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)^2]
\label{eqn:varfisher}
\end{align}</mathjax></p>
<p>Using this result we can use the Cauchy-Schwarz&nbsp;inequality</p>
<div class="formula">
<span class="bigsymbol">(</span><span class="textrm">Cov</span>[<i>X</i>, <i>Y</i>]<span class="bigsymbol">)</span><sup>2</sup> ≤ <i>σ</i><span class="scripts"><sup class="script">2</sup><sub class="script"><i>X</i></sub></span><i>σ</i><span class="scripts"><sup class="script">2</sup><sub class="script"><i>Y</i></sub></span><a class="eqnumber" name="eqn:inequality"> </a>
</div>
<p>where <span class="formula"><span class="textrm">Cov</span>[<i>X</i>, <i>Y</i>]</span>
 is the covariance defined&nbsp;as</p>
<div class="formula">
<span class="textrm">Cov</span>[<i>X</i>, <i>Y</i>] = <i>E</i>[<i><span class="caps">XY</span></i>] − <i>E</i>[<i>X</i>]<i>E</i>[<i>Y</i>]
</div>
<p>we should be able to reach an equation relating the variance in a
parameter to the Fisher Information. Firstly We define a statistic
<span class="formula"><i>T</i> = <i>r</i>(<i>t⃗</i>)</span>
 which is an estimator of the parameter
<span class="formula">Θ</span>
. Using equation [eqn:inequality] we see&nbsp;that</p>
<p><mathjax>\begin{align}
\textrm{Cov}[T,\frac{\partial\lambda_n}{\partial\Theta}] = E[T\frac{\partial\lambda_n}{\partial\Theta}]-
E[T]E[\frac{\partial\lambda_n}{\partial\Theta}]
\end{align}</mathjax></p>
<p>Which using equation \ref{eqn:tozero} reduces to
<mathjax>\begin{align}
\textrm{Cov}[T,\frac{\partial\lambda_n}{\partial\Theta}] = \int\cdots\int r(\vec{t})\frac{\partial\lambda_n}{\partial\Theta}
dt_1\cdots dt_n =\frac{\partial m(\Theta)}{\partial\Theta}
\end{align}</mathjax>
Therefore using the Cauchy-Schwarz inequality with equations \ref{eqn:varfisher} and \ref{eqn:nfisher} we now see
<mathjax>\begin{align}
\Big(\textrm{Cov}[T,\frac{\partial\lambda_n}{\partial\Theta}]\Big)^2
\leq \textrm{Var}[T]\textrm{Var}[\frac{\partial\lambda_n}{\partial\Theta}]\\\\
\Big(\frac{\partial m(\Theta)}{\partial\Theta}\Big)^2 \leq \textrm{Var}[T]nI(\Theta)\\\\
\boxed{\textrm{Var}[T] \geq \Big(\frac{\partial m(\Theta)}{\partial\Theta}\Big)^2\frac{1}{nI(\Theta)}}
\end{align}</mathjax>
And thus we get to the Cramer-Rao lower bound. For this to be valid, the statistic <mathjax>$T$</mathjax> must follow the form
<mathjax>\begin{align}
r(\vec{t})=u(\Theta)\frac{\partial\lambda_n}{\partial\Theta}+v(\Theta)
\end{align}</mathjax></p>
</div>
</div>
<div class="section" id="references">
<h2>References</h2>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>DeGROOT, Morris H., and Mark J. Schervish. &quot;Probability and Statistics. 2002.</td></tr>
</tbody>
</table>
</div>
<script type= "text/javascript">
    if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
        var mathjaxscript = document.createElement('script');
        mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
        mathjaxscript.type = 'text/javascript';
        mathjaxscript.src = 'https:' == document.location.protocol
                ? 'https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'
                : 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
        mathjaxscript[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" +
            "    config: ['MMLorHTML.js']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    displayAlign: 'center'," +
            "    displayIndent: '0em'," +
            "    showMathMenu: true," +
            "    tex2jax: { " +
            "        inlineMath: [ ['$','$'] ], " +
            "        displayMath: [ ['$$','$$'] ]," +
            "        processEscapes: true," +
            "        preview: 'TeX'," +
            "    }, " +
            "    'HTML-CSS': { " +
            "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
    }
</script>

            </div>
            <!-- /.entry-content -->
<!--            -->
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm hidden-print" id="sidebar">
<aside class='hidden-print'>
    <section>

            <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Contact Me</h4></li>
            <center>
            <a href="http://www.linkedin.com/pub/mark-s-brown/48/95a/70"><i class="icon-linkedin-sign icon-large" ></i></a>

            <script language="Javascript">
            u = 'sandcalc';
                        
            document.write('<a href=\"http://www.twitter.com/' + u + '\" target=\"_blank\">'); 
            </script>
            <i class="icon-twitter icon-large" ></i></a>

            <script language="JavaScript">
              u = 'sandcalc';
              document.write('<a href=\"skype:' + u + '?call' + '\" target=\"_blank\">');
            </script>
            <i class="icon-skype icon-large"></i></a>

            <script language="JavaScript">
              u = 'zcicg94';
              s = 'ucl.ac.uk';
              document.write('<a href=\"mailto:' + u + '@' + s + '\" target=\"_blank\">');
            </script>
            <i class="icon-envelope icon-large"></i></a>
<!--            <a href="http://markbrown.io/feeds/all.rss.xml" rel="alternate" title="Recent Blog Posts"><i class="icon-rss icon-large"></i></a>-->
            </center>
            </li>

<!--            <li class="list-group-item"><a href="http://markbrown.io/tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li>-->
<!--            -->
<!--                <li class="list-group-item tag-4">-->
<!--                    <a href="http://markbrown.io/tag/ccc.html">-->
<!--                        ccc-->
<!--                    </a>-->
<!--                </li>-->
<!--            -->
<!--                <li class="list-group-item tag-4">-->
<!--                    <a href="http://markbrown.io/tag/specular.html">-->
<!--                        specular-->
<!--                    </a>-->
<!--                </li>-->
<!--            -->
<!--                <li class="list-group-item tag-4">-->
<!--                    <a href="http://markbrown.io/tag/crlb.html">-->
<!--                        crlb-->
<!--                    </a>-->
<!--                </li>-->
<!--            -->
<!--                <li class="list-group-item tag-4">-->
<!--                    <a href="http://markbrown.io/tag/scintillator.html">-->
<!--                        scintillator-->
<!--                    </a>-->
<!--                </li>-->
<!--            -->
<!--                <li class="list-group-item tag-4">-->
<!--                    <a href="http://markbrown.io/tag/light.html">-->
<!--                        light-->
<!--                    </a>-->
<!--                </li>-->
<!--            -->
        </ul>
    </section>


    <section class='hidden-print'>
    <ul class="list-group list-group-flush">
    <li class="list-group-item"><h4><i class="icon-github icon-large"></i>GitHub Repos</h4></li>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
    </ul>
        <script type="text/javascript">
            $(document).ready(function () {
                if (!window.jXHR) {
                    var jxhr = document.createElement('script');
                    jxhr.type = 'text/javascript';
                    jxhr.src = 'http://markbrown.io/theme/js/jXHR.js';
                    var s = document.getElementsByTagName('script')[0];
                    s.parentNode.insertBefore(jxhr, s);
                }

                github.showRepos({
                    user: 'marksbrown',
                    count: 5,
                    skip_forks: false,
                    target: '#gh_repos',
                    sort_attribute: 'pushed_at',
                    sort_descending: true
                });
            });
        </script>
        <script src="http://markbrown.io/theme/js/github.js" type="text/javascript"></script>
    </section>
</aside>        </div>
    </div>
</div>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://markbrown.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://markbrown.io/theme/js/respond.min.js"></script>
</body>
</html>