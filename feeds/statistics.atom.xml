<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>markbrown.io</title><link href="http://markbrown.io/" rel="alternate"></link><link href="http://markbrown.io/feeds/statistics.atom.xml" rel="self"></link><id>http://markbrown.io/</id><updated>2013-11-29T00:00:00+01:00</updated><entry><title>Cramer Rao Lower Bound</title><link href="http://markbrown.io/cramer-rao-lower-bound.html" rel="alternate"></link><updated>2013-11-29T00:00:00+01:00</updated><author><name>Mark</name></author><id>tag:markbrown.io,2013-11-29:cramer-rao-lower-bound.html</id><summary type="html">&lt;p&gt;The time resolution of the scintillator detector may be estimated from a probability density function (&lt;span class="caps"&gt;PDF&lt;/span&gt;) describing the signal generated by a given particle interaction. To understand how this is accomplished, a (brief) introduction to Likelihood statistics is&amp;nbsp;given.&lt;/p&gt;
&lt;p&gt;The likelihood function is the probability of &amp;#8216;guessed&amp;#8217; parameters for observed data. Whereas the &lt;span class="caps"&gt;PDF&lt;/span&gt; is the probability of data given parameters, the likelihood function is the probability of parameters given data. It is intuitive to see that the likelihood function will reach a maximum when the parameters are the most likely. We therefore define
\begin{align}
L(\theta|t) = p(t|\Theta)&amp;#92;&amp;#92;
\lambda(t|\Theta) = \ln{p(t|\Theta)}
\end{align}
where $L$ is the likelihood function, $p$ is the probability density function, $\lambda$ is the log-likelihood function, $t$ is a given observed event and $\theta$ is the parameter under interest. For $N$ individual events, a random sample $\vec{t}=\{t_1,t_2,\cdots,t_n\}$, with no order implied, these equations become
\begin{align}
L(\Theta|\vec{t}) = \prod^n_{i=1}p(t_i|\Theta)&amp;#92;&amp;#92;
\lambda_n(\vec{t}|\Theta) = \sum^n_{i=1}\lambda(t_i|\Theta)
\end{align}
As the likelihood function defines the probability the estimated parameters are correct, it is natural to maximise $L$ to find the most likely parameters for the sample $\vec{t}$. The definition above however will generally be zero, except for exceedingly close to the correct values, due to the product of many infinitesimally small numbers. Due to this we generally maximise the log-likelihood as the resulting parameters we find will be the same, but the distribution of the log-likelihood function about the optimal parameters will be smoother. This method is known as Maximum Likelihood Estimation (&lt;span class="caps"&gt;MLE&lt;/span&gt;) &lt;a class="footnote-reference" href="#id2" id="id1"&gt;[1]&lt;/a&gt;&amp;nbsp;.&lt;/p&gt;
&lt;p&gt;The parameter of interest for the timing performance of a scintillator detector is the absolute time of arrival of a high energy particle within the scintillator crystal. The standard deviation of the uncertainty within this parameter we shall refer to as the time&amp;nbsp;resolution.&lt;/p&gt;
&lt;div class="section" id="the-scintillation-mechanism"&gt;
&lt;h2&gt;The Scintillation&amp;nbsp;Mechanism&lt;/h2&gt;
&lt;img alt="pdf and cdf for LSO" src="/images/LSO-pdf-cdf.png" style="width: 80%;" /&gt;
&lt;p&gt;The rate of photon generation within the scintillator crystal typically described by two exponentials[&lt;span class="caps"&gt;REFERENCE&lt;/span&gt;]. The &lt;span class="caps"&gt;PDF&lt;/span&gt; is given&amp;nbsp;by&lt;/p&gt;
&lt;p&gt;\begin{align}
p(t|\Theta,\tau_r,\tau_d) = \begin{cases}\frac{1}{\tau_d-\tau_r}\Big[e^{\frac{-(t-\Theta)}{\tau_d}}-e^{\frac{-(t-\Theta)}{\tau_r}}\Big] &amp;amp;\qquad\mbox{if } t \geq\Theta &amp;#92;&amp;#92;
0 &amp;amp;\qquad \mbox{if } t &amp;lt; \Theta \end{cases}
\label{eqn:dual}&amp;nbsp;\end{align}&lt;/p&gt;
&lt;p&gt;where $\tau_r$ is the rise time, $\tau_d$ is the decay time and $\Theta$ is the particle conversion time within the scintillator&amp;nbsp;crystal.&lt;/p&gt;
&lt;div class="section" id="cramer-rao-derivation"&gt;
&lt;h3&gt;Cramer-Rao&amp;nbsp;Derivation&lt;/h3&gt;
&lt;p&gt;We begin by determining the expectation value of&amp;nbsp;$\frac{\partial\lambda_n}{\partial\Theta}$&lt;/p&gt;
&lt;p&gt;\begin{align}
\frac{\partial\lambda_n}{\partial\Theta} = \frac{\partial}{\partial\Theta}\ln p_n(\vec{t}|\Theta)=
\frac{1}{p_n}\frac{\partial p_n}{\partial\Theta}
&amp;#92;&amp;#92;
\textrm{E}[\Big(\frac{\partial\lambda_n}{\partial\Theta}\Big)] = \int\cdots\int \frac{1}{p_n}\frac{\partial p_n}{\partial\Theta}f_n dt_1\cdots dt_n&amp;#92;&amp;#92;
\textrm{E}[\Big(\frac{\partial\lambda_n}{\partial\Theta}\Big)] = \int\cdots\int \frac{\partial p_n}{\partial\Theta} dt_1\cdots dt_n = 0
\label{eqn:tozero}&amp;nbsp;\end{align}&lt;/p&gt;
&lt;p&gt;This equals zero because one of the properties of the &lt;span class="caps"&gt;PDF&lt;/span&gt;&amp;nbsp;is&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;span class="limits"&gt;&lt;sup class="limit"&gt; &lt;/sup&gt;&lt;span class="limit"&gt;&lt;span class="symbol"&gt;∫&lt;/span&gt;&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;S&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;p&lt;/i&gt;(&lt;i&gt;t&lt;/i&gt;|Θ)&lt;i&gt;dt&lt;/i&gt; = 1
&lt;/div&gt;
&lt;p&gt;where &lt;span class="formula"&gt;&lt;i&gt;S&lt;/i&gt;&lt;/span&gt;
 is every possible value of &lt;span class="formula"&gt;&lt;i&gt;t&lt;/i&gt;&lt;/span&gt;
. We can use this
result to redefine the Fisher information (equation [eqn:fisher]) in
terms of variance such&amp;nbsp;that&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;span class="textrm"&gt;Var&lt;/span&gt;[&lt;i&gt;X&lt;/i&gt;]: = &lt;span class="textrm"&gt;Cov&lt;/span&gt;[&lt;i&gt;X&lt;/i&gt;, &lt;i&gt;X&lt;/i&gt;] = &lt;i&gt;E&lt;/i&gt;[&lt;i&gt;X&lt;/i&gt;&lt;sup&gt;2&lt;/sup&gt;] − &lt;i&gt;E&lt;/i&gt;[&lt;i&gt;X&lt;/i&gt;]&lt;sup&gt;2&lt;/sup&gt;
&lt;/div&gt;
&lt;p&gt;Therefore&lt;/p&gt;
&lt;p&gt;\begin{align}
\textrm{Var}[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)] =
E[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)^2]-E[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)]^2&amp;#92;&amp;#92;
I(\Theta) = \textrm{Var}[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)] =
E[\Big(\frac{\partial\lambda}{\partial\Theta}\Big)^2]
\label{eqn:varfisher}&amp;nbsp;\end{align}&lt;/p&gt;
&lt;p&gt;Using this result we can use the Cauchy-Schwarz&amp;nbsp;inequality&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;span class="bigsymbol"&gt;(&lt;/span&gt;&lt;span class="textrm"&gt;Cov&lt;/span&gt;[&lt;i&gt;X&lt;/i&gt;, &lt;i&gt;Y&lt;/i&gt;]&lt;span class="bigsymbol"&gt;)&lt;/span&gt;&lt;sup&gt;2&lt;/sup&gt; ≤ &lt;i&gt;σ&lt;/i&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;2&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;X&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;σ&lt;/i&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;2&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;Y&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;a class="eqnumber" name="eqn:inequality"&gt; &lt;/a&gt;
&lt;/div&gt;
&lt;p&gt;where &lt;span class="formula"&gt;&lt;span class="textrm"&gt;Cov&lt;/span&gt;[&lt;i&gt;X&lt;/i&gt;, &lt;i&gt;Y&lt;/i&gt;]&lt;/span&gt;
 is the covariance defined&amp;nbsp;as&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;span class="textrm"&gt;Cov&lt;/span&gt;[&lt;i&gt;X&lt;/i&gt;, &lt;i&gt;Y&lt;/i&gt;] = &lt;i&gt;E&lt;/i&gt;[&lt;i&gt;&lt;span class="caps"&gt;XY&lt;/span&gt;&lt;/i&gt;] − &lt;i&gt;E&lt;/i&gt;[&lt;i&gt;X&lt;/i&gt;]&lt;i&gt;E&lt;/i&gt;[&lt;i&gt;Y&lt;/i&gt;]
&lt;/div&gt;
&lt;p&gt;we should be able to reach an equation relating the variance in a
parameter to the Fisher Information. Firstly We define a statistic
&lt;span class="formula"&gt;&lt;i&gt;T&lt;/i&gt; = &lt;i&gt;r&lt;/i&gt;(&lt;i&gt;t⃗&lt;/i&gt;)&lt;/span&gt;
 which is an estimator of the parameter
&lt;span class="formula"&gt;Θ&lt;/span&gt;
. Using equation [eqn:inequality] we see&amp;nbsp;that&lt;/p&gt;
&lt;p&gt;\begin{align}
\textrm{Cov}[T,\frac{\partial\lambda_n}{\partial\Theta}] = E[T\frac{\partial\lambda_n}{\partial\Theta}]-
E[T]E[\frac{\partial\lambda_n}{\partial\Theta}]&amp;nbsp;\end{align}&lt;/p&gt;
&lt;p&gt;Which using equation \ref{eqn:tozero} reduces to
\begin{align}
\textrm{Cov}[T,\frac{\partial\lambda_n}{\partial\Theta}] = \int\cdots\int r(\vec{t})\frac{\partial\lambda_n}{\partial\Theta}
dt_1\cdots dt_n =\frac{\partial m(\Theta)}{\partial\Theta}
\end{align}
Therefore using the Cauchy-Schwarz inequality with equations \ref{eqn:varfisher} and \ref{eqn:nfisher} we now see
\begin{align}
\Big(\textrm{Cov}[T,\frac{\partial\lambda_n}{\partial\Theta}]\Big)^2
\leq \textrm{Var}[T]\textrm{Var}[\frac{\partial\lambda_n}{\partial\Theta}]&amp;#92;&amp;#92;
\Big(\frac{\partial m(\Theta)}{\partial\Theta}\Big)^2 \leq \textrm{Var}[T]nI(\Theta)&amp;#92;&amp;#92;
\boxed{\textrm{Var}[T] \geq \Big(\frac{\partial m(\Theta)}{\partial\Theta}\Big)^2\frac{1}{nI(\Theta)}}
\end{align}
And thus we get to the Cramer-Rao lower bound. For this to be valid, the statistic $T$ must follow the form
\begin{align}
r(\vec{t})=u(\Theta)\frac{\partial\lambda_n}{\partial\Theta}+v(\Theta)&amp;nbsp;\end{align}&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;table class="docutils footnote" frame="void" id="id2" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id1"&gt;[1]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;DeGROOT, Morris H., and Mark J. Schervish. &amp;quot;Probability and Statistics. 2002.&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</summary></entry></feed>